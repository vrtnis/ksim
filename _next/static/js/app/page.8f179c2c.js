(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{8562:function(e,t,n){Promise.resolve().then(n.bind(n,8212))},8212:function(e,t,n){"use strict";n.r(t);var i=n(7437);n(2265);var r=n(6014),o=n(511),a=n(1326),s=n(3293);t.default=()=>(0,i.jsxs)(r.Z,{maxWidth:"lg",children:[(0,i.jsx)(a.Z,{sx:{my:4},children:(0,i.jsx)(o.Z,{variant:"h2",component:"h1",gutterBottom:!0,children:"Welcome to My Next.js App"})}),(0,i.jsx)(s.W_,{name:"installation",children:(0,i.jsxs)(a.Z,{sx:{my:4},children:[(0,i.jsx)(o.Z,{variant:"h3",component:"h2",gutterBottom:!0,children:"Installation"}),(0,i.jsx)(o.Z,{variant:"body1",gutterBottom:!0,children:"Clone this repository:"}),(0,i.jsx)("pre",{children:(0,i.jsxs)("code",{children:["git clone https://github.com/kscalelabs/ksim.git",(0,i.jsx)("br",{}),"cd ksim"]})}),(0,i.jsx)(o.Z,{variant:"body1",gutterBottom:!0,children:"It is recommended that you use a virtual environment to install the dependencies for this project. You can create a new conda environment using the following command:"}),(0,i.jsx)("pre",{children:(0,i.jsxs)("code",{children:["conda create --name ksim python=3.11",(0,i.jsx)("br",{}),"conda activate ksim"]})}),(0,i.jsx)(o.Z,{variant:"body1",gutterBottom:!0,children:"To install the dependencies, run the following command:"}),(0,i.jsx)("pre",{children:(0,i.jsx)("code",{children:"make install-dev"})}),(0,i.jsx)(o.Z,{variant:"body1",gutterBottom:!0,children:"Finally, add your Weights & Biases API key via conda:"}),(0,i.jsx)("pre",{children:(0,i.jsx)("code",{children:"conda env config vars set WANDB_API_KEY=<your api key>"})})]})}),(0,i.jsx)(s.W_,{name:"mjx-gym-usage",children:(0,i.jsxs)(a.Z,{sx:{my:4},children:[(0,i.jsx)(o.Z,{variant:"h3",component:"h2",gutterBottom:!0,children:"MJX Gym Usage"}),(0,i.jsx)(o.Z,{variant:"body1",gutterBottom:!0,children:"MJX Gym is a library for training and evaluating reinforcement learning agents in MJX environments. It is built on top of the Brax library and provides a simple interface for running experiments with Stompy and other humanoid form factors. Currently, we support walking but plan on adding more tasks and simulator environments in the future."})]})}),(0,i.jsx)(s.W_,{name:"training",children:(0,i.jsxs)(a.Z,{sx:{my:4},children:[(0,i.jsx)(o.Z,{variant:"h3",component:"h2",gutterBottom:!0,children:"Training"}),(0,i.jsx)(o.Z,{variant:"body1",gutterBottom:!0,children:"For quick experimentation, you may specify all relevant training configurations via YAML files, and simply run train.py with the desired configuration. Our configurations allow for rapid reward function prototyping, environment specification, and hyperparameter tuning. Additionally, all training results are tracked and logged using Weights & Biases."}),(0,i.jsx)(o.Z,{variant:"body1",gutterBottom:!0,children:"We recommend starting with the default humanoid environment to get a feel for the simulator. To train the default humanoid environment, first navigate to the /mjx_gym directory:"}),(0,i.jsx)("pre",{children:(0,i.jsx)("code",{children:"cd ksim/mjx_gym"})}),(0,i.jsx)(o.Z,{variant:"body1",gutterBottom:!0,children:"Then, run the following command:"}),(0,i.jsx)("pre",{children:(0,i.jsx)("code",{children:"python train.py --config experiments/default_humanoid_walk.yaml"})}),(0,i.jsx)(o.Z,{variant:"body1",gutterBottom:!0,children:"Example training curves are shown below:"})]})}),(0,i.jsx)(s.W_,{name:"testing-and-rendering",children:(0,i.jsxs)(a.Z,{sx:{my:4},children:[(0,i.jsx)(o.Z,{variant:"h3",component:"h2",gutterBottom:!0,children:"Testing and Rendering"}),(0,i.jsx)(o.Z,{variant:"body1",gutterBottom:!0,children:"We provide an easy way to test and render the trained model using the play.py script. This script loads the trained model and runs it in the specified environment."}),(0,i.jsx)(o.Z,{variant:"body1",gutterBottom:!0,children:"To test and render the trained model, run the following command:"}),(0,i.jsx)("pre",{children:(0,i.jsx)("code",{children:"python play.py --config experiments/default_humanoid_walk.yaml"})}),(0,i.jsx)(o.Z,{variant:"body1",gutterBottom:!0,children:"Here is an example of the trained model walking in the default humanoid environment after roughly 15 minutes of training on the K-Scale cluster."}),(0,i.jsx)(o.Z,{variant:"body1",gutterBottom:!0,children:"You may transfer the model (trained via MJX) to MuJoCo for CPU-based simulation via arguments to the play script. For example, to run the model in the default humanoid environment, use the following command:"}),(0,i.jsx)("pre",{children:(0,i.jsx)("code",{children:"python play.py --config experiments/default_humanoid_walk.yaml --use_mujoco"})}),(0,i.jsx)(o.Z,{variant:"body1",gutterBottom:!0,children:"It is important that the configuration file used for testing is the same as the one used for training. This ensures that the model is loaded correctly and avoids any catastrophic failures during testing. For simplicity, we have included default training weights in the /mjx_gym/weights directory, which are automatically used when running the play script with the command above. However, you may specify a different weight file using the --params_path argument."}),(0,i.jsx)(o.Z,{variant:"body1",gutterBottom:!0,children:"Here is an example of the trained model (in MJX) walking in the default humanoid environment in MuJoCo."}),(0,i.jsx)(o.Z,{variant:"body1",gutterBottom:!0,children:"While the model performs well in the MJX environment, it is important to note that the models performance may vary when transferred to MuJoCo. This is due to slight differences in the simulators and the underlying physics engines. Evaluating the model in both simulators is helpful for determining whether the model will generalize well across different environments."}),(0,i.jsx)(o.Z,{variant:"body1",gutterBottom:!0,children:"Getting Stompy to walk in MJX is a challenging task, and we encourage the open-source community to contribute toward training efforts. The most recent set of weights allows Stompy (without upper body) to maintain balance in a stable environment. An example trajectory is included below:"})]})}),(0,i.jsx)(s.W_,{name:"running-from-slurm-cluster",children:(0,i.jsxs)(a.Z,{sx:{my:4},children:[(0,i.jsx)(o.Z,{variant:"h3",component:"h2",gutterBottom:!0,children:"Running from SLURM Cluster"}),(0,i.jsx)(o.Z,{variant:"body1",gutterBottom:!0,children:"To run from a SLURM cluster (e.g. the K-Scale Andromeda cluster), cd to /mjx_gym/ and run:"}),(0,i.jsx)("pre",{children:(0,i.jsx)("code",{children:"sbatch scripts/train.slurm"})}),(0,i.jsx)(o.Z,{variant:"body1",gutterBottom:!0,children:"Training logs, errors, and GPU utilization will be tracked in the /logs/ directory."})]})}),(0,i.jsx)(s.W_,{name:"common-issues",children:(0,i.jsxs)(a.Z,{sx:{my:4},children:[(0,i.jsx)(o.Z,{variant:"h3",component:"h2",gutterBottom:!0,children:"Common Issues"}),(0,i.jsx)(o.Z,{variant:"body1",gutterBottom:!0,children:"You might see the following error when running train.py:"}),(0,i.jsx)("pre",{children:(0,i.jsx)("code",{children:"An NVIDIA GPU may be present on this machine, but a CUDA-enabled jaxlib is not installed. Falling back to cpu."})}),(0,i.jsx)(o.Z,{variant:"body1",gutterBottom:!0,children:"One way to fix this issue is to uninstall jax and jaxlib and reinstall them with your specific CUDA version the following commands:"}),(0,i.jsx)("pre",{children:(0,i.jsxs)("code",{children:["pip uninstall jax jaxlib",(0,i.jsx)("br",{}),"pip install --upgrade jax[cuda12] -f https://storage.googleapis.com/jax-releases/jax_cuda_releases.html"]})}),(0,i.jsx)(o.Z,{variant:"body1",gutterBottom:!0,children:"Note that the CUDA version should match the one installed on your machine."}),(0,i.jsx)(o.Z,{variant:"body1",gutterBottom:!0,children:"A similar issue might also occur:"}),(0,i.jsx)("pre",{children:(0,i.jsx)("code",{children:"jaxlib.xla_extension.XlaRuntimeError: FAILED_PRECONDITION: DNN library initialization failed. Look at the errors above for more details."})}),(0,i.jsx)(o.Z,{variant:"body1",gutterBottom:!0,children:"This error is usually caused by an incorrect version of cudnn installed in your environment. To fix this issue, you can try installing cuDNN using the following command:"}),(0,i.jsx)("pre",{children:(0,i.jsx)("code",{children:"conda install cudnn"})}),(0,i.jsx)(o.Z,{variant:"body1",gutterBottom:!0,children:"Another common issue occurs when rendering on a headless server. For now, we recommend rendering locally or using a remote desktop connection to view the rendering."})]})}),(0,i.jsx)(s.W_,{name:"mjcf-reference",children:(0,i.jsxs)(a.Z,{sx:{my:4},children:[(0,i.jsx)(o.Z,{variant:"h3",component:"h2",gutterBottom:!0,children:"MJCF Reference"}),(0,i.jsx)(o.Z,{variant:"body1",gutterBottom:!0,children:"To visualize any MJCF file, you can run the following command:"}),(0,i.jsx)("pre",{children:(0,i.jsx)("code",{children:"python3 -m mujoco.viewer --mjcf <path-to-mjcf-file>"})}),(0,i.jsx)(o.Z,{variant:"body1",gutterBottom:!0,children:"The command above loads MuJoCos GUI, which allows you to simulate the model, manually specify joints, and save keyframes."})]})})]})}},function(e){e.O(0,[649,971,23,744],function(){return e(e.s=8562)}),_N_E=e.O()}]);