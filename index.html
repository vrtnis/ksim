<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" as="script" fetchPriority="low" href="/ksim/_next/static/js/webpack.bbc42d40.js"/><script src="/ksim/_next/static/js/fd9d1056.ccd34a12.js" async=""></script><script src="/ksim/_next/static/js/7023.d62f1316.js" async=""></script><script src="/ksim/_next/static/js/main-app.9ee244c1.js" async=""></script><script src="/ksim/_next/static/js/4981.be8d721a.js" async=""></script><script src="/ksim/_next/static/js/641.d4b1c358.js" async=""></script><script src="/ksim/_next/static/js/app/page.3c15bed5.js" async=""></script><script src="/ksim/_next/static/js/3678.09547ba2.js" async=""></script><script src="/ksim/_next/static/js/app/layout.2a499721.js" async=""></script><title>K-Scale Labs Sim</title><meta name="description" content="A simple and efficient library for training humanoid locomotion in MJX and MuJoCo."/><link rel="icon" href="/ksim/favicon.ico" type="image/x-icon" sizes="16x16"/><script src="/ksim/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js" noModule=""></script></head><body><style data-emotion="css-global o6gwfi">html{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;box-sizing:border-box;-webkit-text-size-adjust:100%;}*,*::before,*::after{box-sizing:inherit;}strong,b{font-weight:700;}body{margin:0;color:rgba(0, 0, 0, 0.87);font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;background-color:#fff;}@media print{body{background-color:#fff;}}body::backdrop{background-color:#fff;}</style><style data-emotion="css k1i2pg">.css-k1i2pg{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:100%;box-sizing:border-box;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;position:static;background-color:#1976d2;color:#fff;}</style><style data-emotion="css 1x7skt0">.css-1x7skt0{background-color:#fff;color:rgba(0, 0, 0, 0.87);-webkit-transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;box-shadow:0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:100%;box-sizing:border-box;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;position:static;background-color:#1976d2;color:#fff;}</style><header class="MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionStatic css-1x7skt0"><style data-emotion="css 1qsxih2">.css-1qsxih2{width:100%;margin-left:auto;box-sizing:border-box;margin-right:auto;display:block;padding-left:16px;padding-right:16px;}@media (min-width:600px){.css-1qsxih2{padding-left:24px;padding-right:24px;}}@media (min-width:1200px){.css-1qsxih2{max-width:1200px;}}</style><div class="MuiContainer-root MuiContainer-maxWidthLg css-1qsxih2"><style data-emotion="css 12o98wt">.css-12o98wt{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;min-height:56px;}@media (min-width:0px){@media (orientation: landscape){.css-12o98wt{min-height:48px;}}}@media (min-width:600px){.css-12o98wt{min-height:64px;}}</style><div class="MuiToolbar-root MuiToolbar-regular css-12o98wt"><style data-emotion="css 1a3lqbo">.css-1a3lqbo{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:500;font-size:1.25rem;line-height:1.6;letter-spacing:0.0075em;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}</style><div class="MuiTypography-root MuiTypography-h6 css-1a3lqbo">K-Scale Sim</div><style data-emotion="css 1guk29">@media (min-width:0px){.css-1guk29{display:none;}}@media (min-width:900px){.css-1guk29{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}</style><div class="MuiBox-root css-1guk29"><a><style data-emotion="css u58v8u">.css-u58v8u{font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:500;font-size:0.875rem;line-height:1.75;letter-spacing:0.02857em;text-transform:uppercase;min-width:64px;padding:6px 8px;border-radius:4px;-webkit-transition:background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;color:inherit;border-color:currentColor;white-space:normal;text-align:center;}.css-u58v8u:hover{-webkit-text-decoration:none;text-decoration:none;background-color:rgba(0, 0, 0, 0.04);}@media (hover: none){.css-u58v8u:hover{background-color:transparent;}}.css-u58v8u.Mui-disabled{color:rgba(0, 0, 0, 0.26);}</style><style data-emotion="css 1g1sdau">.css-1g1sdau{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;position:relative;box-sizing:border-box;-webkit-tap-highlight-color:transparent;background-color:transparent;outline:0;border:0;margin:0;border-radius:0;padding:0;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;-moz-appearance:none;-webkit-appearance:none;-webkit-text-decoration:none;text-decoration:none;color:inherit;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:500;font-size:0.875rem;line-height:1.75;letter-spacing:0.02857em;text-transform:uppercase;min-width:64px;padding:6px 8px;border-radius:4px;-webkit-transition:background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;color:inherit;border-color:currentColor;white-space:normal;text-align:center;}.css-1g1sdau::-moz-focus-inner{border-style:none;}.css-1g1sdau.Mui-disabled{pointer-events:none;cursor:default;}@media print{.css-1g1sdau{-webkit-print-color-adjust:exact;color-adjust:exact;}}.css-1g1sdau:hover{-webkit-text-decoration:none;text-decoration:none;background-color:rgba(0, 0, 0, 0.04);}@media (hover: none){.css-1g1sdau:hover{background-color:transparent;}}.css-1g1sdau.Mui-disabled{color:rgba(0, 0, 0, 0.26);}</style><button class="MuiButtonBase-root MuiButton-root MuiButton-text MuiButton-textInherit MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-colorInherit MuiButton-root MuiButton-text MuiButton-textInherit MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-colorInherit css-1g1sdau" tabindex="0" type="button">Installation</button></a><a><button class="MuiButtonBase-root MuiButton-root MuiButton-text MuiButton-textInherit MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-colorInherit MuiButton-root MuiButton-text MuiButton-textInherit MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-colorInherit css-1g1sdau" tabindex="0" type="button">MJX Gym Usage</button></a><a><button class="MuiButtonBase-root MuiButton-root MuiButton-text MuiButton-textInherit MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-colorInherit MuiButton-root MuiButton-text MuiButton-textInherit MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-colorInherit css-1g1sdau" tabindex="0" type="button">Training</button></a><a><button class="MuiButtonBase-root MuiButton-root MuiButton-text MuiButton-textInherit MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-colorInherit MuiButton-root MuiButton-text MuiButton-textInherit MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-colorInherit css-1g1sdau" tabindex="0" type="button">Testing and Rendering</button></a><a><button class="MuiButtonBase-root MuiButton-root MuiButton-text MuiButton-textInherit MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-colorInherit MuiButton-root MuiButton-text MuiButton-textInherit MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-colorInherit css-1g1sdau" tabindex="0" type="button">Running from SLURM Cluster</button></a><a><button class="MuiButtonBase-root MuiButton-root MuiButton-text MuiButton-textInherit MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-colorInherit MuiButton-root MuiButton-text MuiButton-textInherit MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-colorInherit css-1g1sdau" tabindex="0" type="button">Common Issues</button></a><a><button class="MuiButtonBase-root MuiButton-root MuiButton-text MuiButton-textInherit MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-colorInherit MuiButton-root MuiButton-text MuiButton-textInherit MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-colorInherit css-1g1sdau" tabindex="0" type="button">MJCF Reference</button></a></div><style data-emotion="css 1m04nb5">@media (min-width:0px){.css-1m04nb5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}@media (min-width:900px){.css-1m04nb5{display:none;}}</style><div class="MuiBox-root css-1m04nb5"><style data-emotion="css 1g5zccb">.css-1g5zccb{text-align:center;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;font-size:1.5rem;padding:8px;border-radius:50%;overflow:visible;color:rgba(0, 0, 0, 0.54);-webkit-transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;margin-left:-12px;color:inherit;padding:12px;font-size:1.75rem;}.css-1g5zccb:hover{background-color:rgba(0, 0, 0, 0.04);}@media (hover: none){.css-1g5zccb:hover{background-color:transparent;}}.css-1g5zccb.Mui-disabled{background-color:transparent;color:rgba(0, 0, 0, 0.26);}</style><style data-emotion="css 1x52uzk">.css-1x52uzk{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;position:relative;box-sizing:border-box;-webkit-tap-highlight-color:transparent;background-color:transparent;outline:0;border:0;margin:0;border-radius:0;padding:0;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;-moz-appearance:none;-webkit-appearance:none;-webkit-text-decoration:none;text-decoration:none;color:inherit;text-align:center;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;font-size:1.5rem;padding:8px;border-radius:50%;overflow:visible;color:rgba(0, 0, 0, 0.54);-webkit-transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;margin-left:-12px;color:inherit;padding:12px;font-size:1.75rem;}.css-1x52uzk::-moz-focus-inner{border-style:none;}.css-1x52uzk.Mui-disabled{pointer-events:none;cursor:default;}@media print{.css-1x52uzk{-webkit-print-color-adjust:exact;color-adjust:exact;}}.css-1x52uzk:hover{background-color:rgba(0, 0, 0, 0.04);}@media (hover: none){.css-1x52uzk:hover{background-color:transparent;}}.css-1x52uzk.Mui-disabled{background-color:transparent;color:rgba(0, 0, 0, 0.26);}</style><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-edgeStart MuiIconButton-sizeLarge css-1x52uzk" tabindex="0" type="button" aria-label="menu"><style data-emotion="css vubbuv">.css-vubbuv{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;fill:currentColor;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;font-size:1.5rem;}</style><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="MenuIcon"><path d="M3 18h18v-2H3zm0-5h18v-2H3zm0-7v2h18V6z"></path></svg></button></div></div></div></header><main><style data-emotion="css 1c0cfyw">.css-1c0cfyw{width:100%;margin-left:auto;box-sizing:border-box;margin-right:auto;display:block;padding-left:16px;padding-right:16px;}@media (min-width:600px){.css-1c0cfyw{padding-left:24px;padding-right:24px;}}@media (min-width:900px){.css-1c0cfyw{max-width:900px;}}</style><div class="MuiContainer-root MuiContainer-maxWidthMd css-1c0cfyw"> <div><style data-emotion="css zitybv">.css-zitybv{margin-top:32px;margin-bottom:32px;}</style><div class="MuiBox-root css-zitybv"><style data-emotion="css 6s8q25">.css-6s8q25{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:3rem;line-height:1.167;letter-spacing:0em;margin-bottom:0.35em;}</style><h2 class="MuiTypography-root MuiTypography-h3 MuiTypography-gutterBottom css-6s8q25">Installation</h2><style data-emotion="css 1tqv6h6">.css-1tqv6h6{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;margin-bottom:0.35em;}</style><p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-1tqv6h6">Clone this repository:</p><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.4285714285714286;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.6666666666666667;padding:8px;float:left;padding-right:10px"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.6666666666666667;padding:8px;white-space:pre">git clone https://github.com/kscalelabs/ksim.git
cd ksim</code></span><p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-1tqv6h6">It is recommended that you use a virtual environment to install the dependencies for this project. You can create a new conda environment using the following command:</p><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.4285714285714286;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.6666666666666667;padding:8px;float:left;padding-right:10px"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.6666666666666667;padding:8px;white-space:pre">conda create --name ksim python=3.11
conda activate ksim</code></span><p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-1tqv6h6">To install the dependencies, run the following command:</p><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.4285714285714286;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.6666666666666667;padding:8px;float:left;padding-right:10px"><span class="react-syntax-highlighter-line-number">1
</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.6666666666666667;padding:8px;white-space:pre">make install-dev</code></span><p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-1tqv6h6">Finally, add your Weights &amp; Biases API key via conda:</p><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.4285714285714286;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.6666666666666667;padding:8px;float:left;padding-right:10px"><span class="react-syntax-highlighter-line-number">1
</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.6666666666666667;padding:8px;white-space:pre">conda env config vars set WANDB_API_KEY=&lt;your api key&gt;</code></span></div></div><div><div class="MuiBox-root css-zitybv"><h2 class="MuiTypography-root MuiTypography-h3 MuiTypography-gutterBottom css-6s8q25">MJX Gym Usage</h2><p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-1tqv6h6">MJX Gym is a library for training and evaluating reinforcement learning agents in MJX environments. It is built on top of the Brax library and provides a simple interface for running experiments with Stompy and other humanoid form factors. Currently, we support walking but plan on adding more tasks and simulator environments in the future.</p></div></div><div><div class="MuiBox-root css-zitybv"><h2 class="MuiTypography-root MuiTypography-h3 MuiTypography-gutterBottom css-6s8q25">Training</h2><p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-1tqv6h6">For quick experimentation, you may specify all relevant training configurations via YAML files, and simply run train.py with the desired configuration. Our configurations allow for rapid reward function prototyping, environment specification, and hyperparameter tuning. Additionally, all training results are tracked and logged using Weights &amp; Biases.</p><p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-1tqv6h6">We recommend starting with the default humanoid environment to get a feel for the simulator. To train the default humanoid environment, first navigate to the /mjx_gym directory:</p><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.4285714285714286;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.6666666666666667;padding:8px;float:left;padding-right:10px"><span class="react-syntax-highlighter-line-number">1
</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.6666666666666667;padding:8px;white-space:pre">cd ksim/mjx_gym</code></span><p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-1tqv6h6">Then, run the following command:</p><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.4285714285714286;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.6666666666666667;padding:8px;float:left;padding-right:10px"><span class="react-syntax-highlighter-line-number">1
</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.6666666666666667;padding:8px;white-space:pre">python train.py --config experiments/default_humanoid_walk.yaml</code></span><p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-1tqv6h6">Example training curves are shown below:</p></div></div><div><div class="MuiBox-root css-zitybv"><h2 class="MuiTypography-root MuiTypography-h3 MuiTypography-gutterBottom css-6s8q25">Testing and Rendering</h2><p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-1tqv6h6">We provide an easy way to test and render the trained model using the play.py script. This script loads the trained model and runs it in the specified environment.</p><p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-1tqv6h6">To test and render the trained model, run the following command:</p><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.4285714285714286;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.6666666666666667;padding:8px;float:left;padding-right:10px"><span class="react-syntax-highlighter-line-number">1
</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.6666666666666667;padding:8px;white-space:pre">python play.py --config experiments/default_humanoid_walk.yaml</code></span><p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-1tqv6h6">Here is an example of the trained model walking in the default humanoid environment after roughly 15 minutes of training on the K-Scale cluster.</p><p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-1tqv6h6">You may transfer the model (trained via MJX) to MuJoCo for CPU-based simulation via arguments to the play script. For example, to run the model in the default humanoid environment, use the following command:</p><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.4285714285714286;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.6666666666666667;padding:8px;float:left;padding-right:10px"><span class="react-syntax-highlighter-line-number">1
</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.6666666666666667;padding:8px;white-space:pre">python play.py --config experiments/default_humanoid_walk.yaml --use_mujoco</code></span><p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-1tqv6h6">It is important that the configuration file used for testing is the same as the one used for training. This ensures that the model is loaded correctly and avoids any catastrophic failures during testing. For simplicity, we have included default training weights in the /mjx_gym/weights directory, which are automatically used when running the play script with the command above. However, you may specify a different weight file using the --params_path argument.</p></div></div><div><div class="MuiBox-root css-zitybv"><h2 class="MuiTypography-root MuiTypography-h3 MuiTypography-gutterBottom css-6s8q25">Running from SLURM Cluster</h2><p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-1tqv6h6">To run from a SLURM cluster (e.g. the K-Scale Andromeda cluster), cd to /mjx_gym/ and run:</p><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.4285714285714286;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.6666666666666667;padding:8px;float:left;padding-right:10px"><span class="react-syntax-highlighter-line-number">1
</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.6666666666666667;padding:8px;white-space:pre">sbatch scripts/train.slurm</code></span><p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-1tqv6h6">Training logs, errors, and GPU utilization will be tracked in the /logs/ directory.</p></div></div><div><div class="MuiBox-root css-zitybv"><h2 class="MuiTypography-root MuiTypography-h3 MuiTypography-gutterBottom css-6s8q25">Common Issues</h2><p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-1tqv6h6">You might see the following error when running train.py:</p><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.4285714285714286;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.6666666666666667;padding:8px;float:left;padding-right:10px"><span class="react-syntax-highlighter-line-number">1
</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.6666666666666667;padding:8px;white-space:pre">An NVIDIA GPU may be present on this machine, but a CUDA-enabled jaxlib is not installed. Falling back to cpu.</code></span><p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-1tqv6h6">One way to fix this issue is to uninstall jax and jaxlib and reinstall them with your specific CUDA version the following commands:</p><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.4285714285714286;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.6666666666666667;padding:8px;float:left;padding-right:10px"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.6666666666666667;padding:8px;white-space:pre">pip uninstall jax jaxlib
pip install --upgrade &quot;jax[cuda12]&quot; -f https://storage.googleapis.com/jax-releases/jax_cuda_releases.html</code></span><p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-1tqv6h6">Note that the CUDA version should match the one installed on your machine.</p><p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-1tqv6h6">A similar issue might also occur:</p><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.4285714285714286;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.6666666666666667;padding:8px;float:left;padding-right:10px"><span class="react-syntax-highlighter-line-number">1
</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.6666666666666667;padding:8px;white-space:pre">jaxlib.xla_extension.XlaRuntimeError: FAILED_PRECONDITION: DNN library initialization failed. Look at the errors above for more details.</code></span><p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-1tqv6h6">This error is usually caused by an incorrect version of cudnn installed in your environment. To fix this issue, you can try installing cuDNN using the following command:</p><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.4285714285714286;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.6666666666666667;padding:8px;float:left;padding-right:10px"><span class="react-syntax-highlighter-line-number">1
</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.6666666666666667;padding:8px;white-space:pre">conda install cudnn</code></span><p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-1tqv6h6">Another common issue occurs when rendering on a headless server. For now, we recommend rendering locally or using a remote desktop connection to view the rendering.</p></div></div><div><div class="MuiBox-root css-zitybv"><h2 class="MuiTypography-root MuiTypography-h3 MuiTypography-gutterBottom css-6s8q25">MJCF Reference</h2><p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-1tqv6h6">To visualize any MJCF file, you can run the following command:</p><span style="font-size:inherit;font-family:inherit;background:#282a36;color:#f8f8f2;border-radius:3px;display:flex;line-height:1.4285714285714286;overflow-x:auto;white-space:pre"><code style="font-size:inherit;font-family:inherit;line-height:1.6666666666666667;padding:8px;float:left;padding-right:10px"><span class="react-syntax-highlighter-line-number">1
</span></code><code style="font-size:inherit;font-family:inherit;line-height:1.6666666666666667;padding:8px;white-space:pre">python3 -m mujoco.viewer --mjcf &lt;path-to-mjcf-file&gt;</code></span><p class="MuiTypography-root MuiTypography-body1 MuiTypography-gutterBottom css-1tqv6h6">The command above loads MuJoCos GUI, which allows you to simulate the model, manually specify joints, and save keyframes.</p></div></div></div></main><script src="/ksim/_next/static/js/webpack.bbc42d40.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:I[95751,[],\"\"]\n3:I[66513,[],\"ClientPageRoot\"]\n4:I[68157,[\"4981\",\"static/js/4981.be8d721a.js\",\"641\",\"static/js/641.d4b1c358.js\",\"1931\",\"static/js/app/page.3c15bed5.js\"],\"default\"]\n5:I[17795,[\"4981\",\"static/js/4981.be8d721a.js\",\"3678\",\"static/js/3678.09547ba2.js\",\"3185\",\"static/js/app/layout.2a499721.js\"],\"default\"]\n6:I[44138,[\"4981\",\"static/js/4981.be8d721a.js\",\"3678\",\"static/js/3678.09547ba2.js\",\"3185\",\"static/js/app/layout.2a499721.js\"],\"default\"]\n7:I[39275,[],\"\"]\n8:I[61343,[],\"\"]\na:I[76130,[],\"\"]\nb:[]\n0:[null,[\"$\",\"$L1\",null,{\"buildId\":\"G_EwLUiroBhN_ZqHpg7nA\",\"assetPrefix\":\"/ksim\",\"initialCanonicalUrl\":\"/\",\"initialTree\":[\"\",{\"children\":[\"__PAGE__\",{}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"__PAGE__\",{},[[\"$L2\",[\"$\",\"$L3\",null,{\"props\":{\"params\":{},\"searchParams\":{}},\"Component\":\"$4\"}]],null],null]},[[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[[\"$\",\"head\",null,{}],[\"$\",\"body\",null,{\"children\":[[\"$\",\"$L5\",null,{}],[\"$\",\"$L6\",null,{\"children\":[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight"])</script><script>self.__next_f.push([1,"\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[],\"styles\":null}]}]]}]]}],null],null],\"couldBeIntercepted\":false,\"initialHead\":[false,\"$L9\"],\"globalErrorComponent\":\"$a\",\"missingSlots\":\"$Wb\"}]]\n"])</script><script>self.__next_f.push([1,"9:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"K-Scale Labs Sim\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"A simple and efficient library for training humanoid locomotion in MJX and MuJoCo.\"}],[\"$\",\"link\",\"4\",{\"rel\":\"icon\",\"href\":\"/ksim/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"16x16\"}]]\n2:null\n"])</script></body></html>